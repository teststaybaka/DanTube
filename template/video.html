{% extends "template/base.html" %}
{% block head %}
{{ super() }}
<link href="/static/player.css" rel="stylesheet" type="text/css">
<script type="text/javascript">
  var tag = document.createElement('script');

  tag.src = "https://www.youtube.com/iframe_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  function onYouTubeIframeAPIReady() {
    player = new YT.Player('player', {
      height: '360',
      width: '100%',
      videoId: '{{ video.cur_vid }}',
      playerVars: {
        autoplay: 0,
        controls: 0,
        showinfo: 0,
        modestbranding: 1,
        enablejsapi: 1,
        rel: 0,
      },
      events: {
        'onReady': onPlayerReady,
        'onStateChange': onPlayerStateChange,
      }
    });
  }
</script>
<script src="/static/video.js" language="JavaScript" type="text/javascript"></script>
{% endblock %}

{% block body %}
<div id="video-info-container" class="container">
  <div id="video-info">
    <div id="video-title">{{ video.title }}</div>
    <div id="video-sub-title-line" class="container">
      <a class="category-link" href="/">Home</a>
      <div class="category-arrow"></div>
      <a class="category-link" href="{{ uri_for(video.category) }}">{{ video.category }}</a>
      <div class="category-arrow"></div>
      <a class="category-link cur-subcategory" href="{{ uri_for([video.category, video.subcategory]|join('-')) }}">{{ video.subcategory }}</a>
      <div class="video-date">{{ video.created }}</div>
      <div class="video-statistic" title="views"><span class="statistic-icon views"></span><span class="commas_number">{{ video.hits }}</span></div>
      <div class="video-statistic" title="favors"><span class="statistic-icon favorites"></span><span class="commas_number">{{ video.favors }}</span></div>
      <div class="video-statistic" title="comments"><span class="statistic-icon comment"></span><span class="commas_number">{{ video.comment_counter }}</span></div>
      <div class="video-statistic" title="bullets"><span class="statistic-icon bullets"></span><span class="commas_number">{{ video.bullets }}</span></div>
    </div>
    <div id="video-parts-container" class="container">
      {% if video.clip_titles|length > 1 %}
        {% for i in video.clip_range %}
          <a class="inline-button episode-link {% if i+1 == video.cur_index %}active{% endif %} {% if i < video.clip_range_min or i > video.clip_range_max %}hidden{% endif %}" href="{{ video.url }}?index={{ i+1 }}">
          {% if video.clip_titles[i] %}
            {{ i+1 }}. {{ video.clip_titles[i] }}
          {% else %}
            Part {{ i+1 }}
          {% endif %}
          </a>
        {% endfor %}
      {% endif %}
      {% if video.clip_titles|length > 3 %}
        <div class="inline-button more-episode">...</div>
      {% endif %}
    </div>
  </div>
  <div id="uploader-info-box">
    <a href="{{ uploader.space_url}}" target="_blank">
      <img id="uploader-img" src="{{ uploader.avatar_url }}">
    </a>
    <div id="uploader-info">
      <div id="uploader-link-line">
        <div id="uploader-link">
          <a class="blue-link" href="{{ uploader.space_url}}" target="_blank">{{ uploader.nickname }}</a>
        </div>
        <div class="inline-button" id="subscribe-button">+ Subscribe</div>
      </div>
      <div id="uploader-intro">{{ uploader.intro }}</div>
    </div>
  </div>
</div>
<div id="player-container" class="container">
  <div id="player-controller">
    <div id="player-canvas">
      <div id="player"></div>
    </div>
    <div id="controller-background">
      <div id="controller" class="container">
        <div id="full-screen" class="off"></div>
        <div id="wide-screen" class="off"></div>
        <div id="loop-switch" class="off">
          <div id="loop-on-tip">Loop On</div>
          <div id="loop-off-tip">Loop Off</div>
        </div>
        <div id="danmaku-switch" class="on">
          <div id="danmaku-on-tip">Danmaku On</div>
          <div id="danmaku-off-tip">Danmaku Off</div>
        </div>
        <div id="volume-controller" class="on">
          <div id="volume-switch"></div>
          <div id="volume-background">
            <div id="volume-bar"></div>
            <div id="volume-magnitude"></div>
            <div id="volume-pointer"></div>
            <div id="volume-tip">23</div>
          </div>
        </div>
        <div id="progress-number">--/--</div>
        <div id="play-pause-button" class="play"></div>
        <div id="progress-bar" ondragstart="return false;" ondrop="return false;" onselectstart="return false;"></div>
        <div id="progress-bar-background" ondragstart="return false;" ondrop="return false;" onselectstart="return false;"></div>
        <div id="progress-bar-buffered" ondragstart="return false;" ondrop="return false;" onselectstart="return false;"></div>
        <div id="progress-bar-played" ondragstart="return false;" ondrop="return false;" onselectstart="return false;"></div>
        <div id="progress-pointer" ondragstart="return false;" ondrop="return false;" onselectstart="return false;"></div>
        <div id="progress-tip">23:23</div>
      </div>
      <div id="shooter" class="container">
        <div id="danmaku-color-setting"></div>
        <input id="danmaku-input" class="normal-input" type="text" name="danmaku">
        <input id="fire-button" type="button" value="Fire!">
      </div>
    </div>
  </div>
  <div id="danmaku-pool">
    <div class="danmaku-order-title" id="time">Time</div>
    <div class="danmaku-order-title" id="content">Content</div>
    <div class="danmaku-order-title" id="date">Date</div>
    <div id="danmaku-list"></div>
  </div>
</div>
<div id="left-info-box">
  <div id="video-detail-info-block">
    <div id="video-tags-line">
      {% for tag in video.tags %}
      <a href="{{ uri_for('search') }}?keywords={{ tag }}" target="_blank" class="tags-link">{{ tag }}</a>
      {% endfor %}
    </div>
    <div id="video-intro-box">{% if video.cur_subintro %}{{ video.cur_subintro }}{% else %}{{ video.description }}{% endif %}</div>
    <div class="container">
      <div class="operation-button" title="Like this!"><span class="operation-icon like"></span><span class="commas_number">{{ video.likes }}</span></div>
      <div class="operation-button" title="Strongly recommend!"><span class="operation-icon bullets"></span><span class="commas_number">{{ video.bullets }}</span></div>
      <div class="operation-button" title="It's my favorite!"><span class="operation-icon favors"></span><span class="commas_number">{{ video.favors }}</span></div>
    </div>
  </div>
  <div id="comments-block-title">Comments <span class="commas_number">{{ video.comment_counter }}</span></div>
  <form id="user-comment-form">
    <img class="comment-img" src="{% if user.is_auth %}{{ user.avatar_url }}{% else %}/static/emoticons_img/default_avatar1.png{% endif %}">
    <div id="write-comment-block">
      <textarea class="normal-input" id="comment-textarea" placeholder="{% if user.is_auth %}Share what you think{% else %}Please sign in{% endif %}"></textarea>
      <div class="container">
        <div class="emoticons-select"></div>
        <input class="inline-button special post" value="Post" type="submit">
      </div>
    </div>
  </form>
  <div id="comments-list-container">
    <!-- <div class="comment-entry no-comment">Be the first one to comment!</div> -->
    <div class="comment-entry">
      <a href="" target="_blank">
        <img class="comment-img" src="">
      </a>
      <div class="comment-detail-box">
        <div class="user-title-line">
          <label class="floorth">#1</label>
          <a class="blue-link user-name" target="_blank">OOOOOOOOOOOOOOOOOOOOOOOOOOOOOO</a>
          <label class="comment-time">2013-12-23 10:20</label>
        </div>
        <div class="comment-content">xvd</div>
        <div class="comment-operation-line">
          <div class="comment-operation">Reply</div>
          <div class="comment-operation report">Report</div>
        </div>
      </div> 
    </div>
  </div>
  <div class="pagination-line"><a class="page-num active" href="">1</a></div>
</div>
{% if playlist %}
<div id="right-video-list">
  <div id="list-title">{{ playlist.title }}</div>
  {% if playlist.intro %}
  <div id="list-intro">{{ playlist.intro }}</div>
  {% endif %}
  <div id="list-scroll-bar">
    {% for list_video in playlist.videos %}
    <div class="list-entry {% if loop.index == playlist.cur_index+1 %}active{% endif %}">
      <div class="list-entry-index {% if loop.index == playlist.cur_index+1 %}active{% endif %}">{{ loop.index }}</div>
      <a href="{{ list_video.url }}" target="_blank">
        <img class="list-video-img" src="{{ list_video.thumbnail_url }}">
      </a>
      <div class="list-entry-info">
        <a class="list-video-title" href="{{ list_video.url }}" target="_blank">{{ list_video.title }}</a>
        <div>
          <div class="list-video-statistic hits"><span class="statistic-icon views"></span>{{ list_video.hits }}</div>
          <div class="list-video-statistic comments"><span class="statistic-icon comment"></span>{{ list_video.comment_counter }}</div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}
{% endblock %}