{% extends "template/account.html" %}
{% block head %}
{{ super() }}
<script type="text/javascript">
var video_subcategories = {};
{% for key in category %}
  video_subcategories['{{ key }}'] = [{% for val in subcategory[key] %}'{{ val }}', {% endfor %}];
{% endfor %}
</script>
<script src="/static/submit.js" language="JavaScript" type="text/javascript"></script>
{% endblock %}

{% block topTitle %}
<a class="top-title" href="{{ uri_for('manage_video') }}">
    <div class="top-title-dot"></div>
    Videos
</a>
<a class="top-title active" href="">
    <div class="top-title-dot"></div>
    Edit
</a>
{% endblock %}

{% block detail %}
<div id="submit-container">
  <form class="change" id="video-submission-form" method="post" enctype="multipart/form-data" action="{{ uri_for('edit_video', video_id=video.id_num) }}">
      <div class="input-line">
        <label for="video-title">Title:</label>
        <input type="text" id="video-title" name="title" value="{{ video.title }}" tabindex="1" placeholder="No longer than 100 characters.">
        <div class="input-error" id="video-title-error">Please.</div>
      </div>
      <div class="input-line">
        <label >Thumbnail:</label>
        <label class="explain">(Optional, animated image not supported)</label>
        <img id="thumbnail-previous-preview" src="{{ video.thumbnail_url }}"></img>
        <div id="thumbnail-spacing"></div>
        <div id="thumbnail-preview">
          <input type="file" name="thumbnail" id="thumbnail-input">
          <div id="thumbnail-hint">Click to select.<br>Leave blank to remain unchanged.</div>
        </div>
        <div class="input-error" id="thumbnail-error">Please.</div>
      </div>
      <div class="input-line">
        <label>Category:</label>
        <select name="category"  id="select-category">
          {% for key in category %}
            <option value="{{ key }}" {% if key == video.category %} selected="selected" {% endif %}>{{ key }}</option>
          {% endfor %}
        </select>
        <select name="subcategory" id="select-subcategory">
          {% for val in subcategory[video.category] %}
            <option value="{{ val }}" {% if val == video.subcategory %} selected="selected" {% endif %} >{{ val }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="input-line">
        <label for="video-description" class="form-label">Description:</label>
        <textarea class="inputtextarea" id="video-description" name="description" tabindex="1" placeholder="No longer than 2000 characters.">{{ video.description }}</textarea>
        <div class="input-error" id="video-description-error">Please.</div>
      </div>
      <div class="input-line">
        <label>Type:</label>
        <div class="option-button type {% if video.type == 'self-made' %}select{% endif %}" id="self-made-option">Self-made</div>
        <div class="option-button type {% if video.type == 'republish' %}select{% endif %}" id="republish-option">Republish</div>
        <input type="text" name="video-type-option" value="{{ video.type }}" class="hidden" id="video-type-option">
      </div>
      <div class="input-line">
        <label for="video-tags">Tags:</label>
        <input type="text"  id="video-tags" name="tags" tabindex="1" placeholder="e.g., flying pig, the binding of isaac, sonic" value="{% for tag in video.tags %}{{ tag }},{% endfor %}">
        <div class="input-error" id="video-tags-error">Please.</div>
        <div>
          <label></label>
          <label for="allow-add" class="check-label">
              <input type="checkbox" class="checkbox" id="allow-add" name="allow-add" tabindex="1" {% if video.allow_tag_add %} checked {% endif %}>
              <span class="checklabel">Allow others to add tags.</span>
          </label>
        </div>
      </div>
      <div class="input-line">
        <label for="video-url">Video URL:</label>
        <label for="video-url" class="explain">(Only support youtube source for now.)</label>
        <input type="text" id="video-url" name="video-url" tabindex="1" placeholder="e,g., https://www.youtube.com/watch?v=8NNTvx5eoXE" value="{{ video.raw_url }}">
        <div class="input-error" id="video-url-error">Please.</div>
      </div>
      <div class="input-line">
        <label>Playlist:</label>
        <div class="option-button playlist select" id="no-playlist-option">No Playlist</div>
        <div class="option-button playlist" id="add-to-playlist-option">Add to Playlist</div>
        <div class="option-button playlist" id="new-playlist-option">New Playlist</div>
        <input type="text" name="playlist-option" value="no-playlist" class="hidden" id="playlist-option">
      </div>
      <div class="input-line hide" id="new-playlist-input">
        <label for="new-playlist-title">New Playlist Title:</label>
        <input type="text" id="new-playlist-title" name="new-playlist-title" tabindex="1" placeholder="No longer than 100 characters.">
      </div>
      <div class="input-line hide" id="add-to-playlist-input">
        <label for="select-playlist">Select Playlist:</label>
        <input type="text" id="select-playlist" name="select-playlist" tabindex="1" placeholder="Click to search and select a playlist.">
      </div>
      <div>
        <input class="save_change-button" type="submit" value="Save Changes" />
        <div id="change-applying"></div>
    </div>
  </form>
</div>
{% endblock %}